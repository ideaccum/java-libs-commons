package org.ideaccum.libs.commons.util;

/**
 * 日本国内の市外局番情報を列挙型で提供します。<br>
 * <p>
 * この列挙型クラスでは、電話番号文字列から市外局番を特定し、期待する番号桁数書式に整形して提供するメソッドも提供します。<br>
 * 日本国内の電話番号の先頭桁数は市外局番によって異なるため、一律の桁数で分割することができないため、列挙型定義として設置されました。<br>
 * </p>
 * <p>
 * この定義情報は2017.3.27時点の総務省公開情報に準拠します。<br>
 * </p>
 * 
 * @author Kitagawa<br>
 * 
 *<!--
 * 更新日		更新者			更新内容
 * 2017/03/27	Kitagawa		新規作成
 * 2018/05/16	Kitagawa		再構築(SourceForge.jpからGitHubへの移行に併せて全面改訂、AddressUtilから分離)
 *-->
 */
public enum JapanesePhoneAreas {

	// 市外局番

	/** 01267 */
	A01267("01267", 5, 1, 4),

	/** 01372 */
	A01372("01372", 5, 1, 4),

	/** 01374 */
	A01374("01374", 5, 1, 4),

	/** 01377 */
	A01377("01377", 5, 1, 4),

	/** 01392 */
	A01392("01392", 5, 1, 4),

	/** 01397 */
	A01397("01397", 5, 1, 4),

	/** 01398 */
	A01398("01398", 5, 1, 4),

	/** 01456 */
	A01456("01456", 5, 1, 4),

	/** 01457 */
	A01457("01457", 5, 1, 4),

	/** 01466 */
	A01466("01466", 5, 1, 4),

	/** 01547 */
	A01547("01547", 5, 1, 4),

	/** 01558 */
	A01558("01558", 5, 1, 4),

	/** 01564 */
	A01564("01564", 5, 1, 4),

	/** 01586 */
	A01586("01586", 5, 1, 4),

	/** 01587 */
	A01587("01587", 5, 1, 4),

	/** 01632 */
	A01632("01632", 5, 1, 4),

	/** 01634 */
	A01634("01634", 5, 1, 4),

	/** 01635 */
	A01635("01635", 5, 1, 4),

	/** 01648 */
	A01648("01648", 5, 1, 4),

	/** 01654 */
	A01654("01654", 5, 1, 4),

	/** 01655 */
	A01655("01655", 5, 1, 4),

	/** 01656 */
	A01656("01656", 5, 1, 4),

	/** 01658 */
	A01658("01658", 5, 1, 4),

	/** 04992 */
	A04992("04992", 5, 1, 4),

	/** 04994 */
	A04994("04994", 5, 1, 4),

	/** 04996 */
	A04996("04996", 5, 1, 4),

	/** 04998 */
	A04998("04998", 5, 1, 4),

	/** 05769 */
	A05769("05769", 5, 1, 4),

	/** 05979 */
	A05979("05979", 5, 1, 4),

	/** 07468 */
	A07468("07468", 5, 1, 4),

	/** 0123 */
	A0123("0123", 4, 2, 4),

	/** 0124 */
	A0124("0124", 4, 2, 4),

	/** 0125 */
	A0125("0125", 4, 2, 4),

	/** 0126 */
	A0126("0126", 4, 2, 4),

	/** 0133 */
	A0133("0133", 4, 2, 4),

	/** 0134 */
	A0134("0134", 4, 2, 4),

	/** 0135 */
	A0135("0135", 4, 2, 4),

	/** 0136 */
	A0136("0136", 4, 2, 4),

	/** 0137 */
	A0137("0137", 4, 2, 4),

	/** 0138 */
	A0138("0138", 4, 2, 4),

	/** 0139 */
	A0139("0139", 4, 2, 4),

	/** 0142 */
	A0142("0142", 4, 2, 4),

	/** 0143 */
	A0143("0143", 4, 2, 4),

	/** 0144 */
	A0144("0144", 4, 2, 4),

	/** 0145 */
	A0145("0145", 4, 2, 4),

	/** 0146 */
	A0146("0146", 4, 2, 4),

	/** 0152 */
	A0152("0152", 4, 2, 4),

	/** 0153 */
	A0153("0153", 4, 2, 4),

	/** 0154 */
	A0154("0154", 4, 2, 4),

	/** 0155 */
	A0155("0155", 4, 2, 4),

	/** 0156 */
	A0156("0156", 4, 2, 4),

	/** 0157 */
	A0157("0157", 4, 2, 4),

	/** 0158 */
	A0158("0158", 4, 2, 4),

	/** 0162 */
	A0162("0162", 4, 2, 4),

	/** 0163 */
	A0163("0163", 4, 2, 4),

	/** 0164 */
	A0164("0164", 4, 2, 4),

	/** 0165 */
	A0165("0165", 4, 2, 4),

	/** 0166 */
	A0166("0166", 4, 2, 4),

	/** 0167 */
	A0167("0167", 4, 2, 4),

	/** 0172 */
	A0172("0172", 4, 2, 4),

	/** 0173 */
	A0173("0173", 4, 2, 4),

	/** 0174 */
	A0174("0174", 4, 2, 4),

	/** 0175 */
	A0175("0175", 4, 2, 4),

	/** 0176 */
	A0176("0176", 4, 2, 4),

	/** 0178 */
	A0178("0178", 4, 2, 4),

	/** 0179 */
	A0179("0179", 4, 2, 4),

	/** 0182 */
	A0182("0182", 4, 2, 4),

	/** 0183 */
	A0183("0183", 4, 2, 4),

	/** 0184 */
	A0184("0184", 4, 2, 4),

	/** 0185 */
	A0185("0185", 4, 2, 4),

	/** 0186 */
	A0186("0186", 4, 2, 4),

	/** 0187 */
	A0187("0187", 4, 2, 4),

	/** 0191 */
	A0191("0191", 4, 2, 4),

	/** 0192 */
	A0192("0192", 4, 2, 4),

	/** 0193 */
	A0193("0193", 4, 2, 4),

	/** 0194 */
	A0194("0194", 4, 2, 4),

	/** 0195 */
	A0195("0195", 4, 2, 4),

	/** 0197 */
	A0197("0197", 4, 2, 4),

	/** 0198 */
	A0198("0198", 4, 2, 4),

	/** 0220 */
	A0220("0220", 4, 2, 4),

	/** 0223 */
	A0223("0223", 4, 2, 4),

	/** 0224 */
	A0224("0224", 4, 2, 4),

	/** 0225 */
	A0225("0225", 4, 2, 4),

	/** 0226 */
	A0226("0226", 4, 2, 4),

	/** 0228 */
	A0228("0228", 4, 2, 4),

	/** 0229 */
	A0229("0229", 4, 2, 4),

	/** 0233 */
	A0233("0233", 4, 2, 4),

	/** 0234 */
	A0234("0234", 4, 2, 4),

	/** 0235 */
	A0235("0235", 4, 2, 4),

	/** 0237 */
	A0237("0237", 4, 2, 4),

	/** 0238 */
	A0238("0238", 4, 2, 4),

	/** 0240 */
	A0240("0240", 4, 2, 4),

	/** 0241 */
	A0241("0241", 4, 2, 4),

	/** 0242 */
	A0242("0242", 4, 2, 4),

	/** 0243 */
	A0243("0243", 4, 2, 4),

	/** 0244 */
	A0244("0244", 4, 2, 4),

	/** 0246 */
	A0246("0246", 4, 2, 4),

	/** 0247 */
	A0247("0247", 4, 2, 4),

	/** 0248 */
	A0248("0248", 4, 2, 4),

	/** 0250 */
	A0250("0250", 4, 2, 4),

	/** 0254 */
	A0254("0254", 4, 2, 4),

	/** 0255 */
	A0255("0255", 4, 2, 4),

	/** 0256 */
	A0256("0256", 4, 2, 4),

	/** 0257 */
	A0257("0257", 4, 2, 4),

	/** 0258 */
	A0258("0258", 4, 2, 4),

	/** 0259 */
	A0259("0259", 4, 2, 4),

	/** 0260 */
	A0260("0260", 4, 2, 4),

	/** 0261 */
	A0261("0261", 4, 2, 4),

	/** 0263 */
	A0263("0263", 4, 2, 4),

	/** 0264 */
	A0264("0264", 4, 2, 4),

	/** 0265 */
	A0265("0265", 4, 2, 4),

	/** 0266 */
	A0266("0266", 4, 2, 4),

	/** 0267 */
	A0267("0267", 4, 2, 4),

	/** 0268 */
	A0268("0268", 4, 2, 4),

	/** 0269 */
	A0269("0269", 4, 2, 4),

	/** 0270 */
	A0270("0270", 4, 2, 4),

	/** 0274 */
	A0274("0274", 4, 2, 4),

	/** 0276 */
	A0276("0276", 4, 2, 4),

	/** 0277 */
	A0277("0277", 4, 2, 4),

	/** 0278 */
	A0278("0278", 4, 2, 4),

	/** 0279 */
	A0279("0279", 4, 2, 4),

	/** 0280 */
	A0280("0280", 4, 2, 4),

	/** 0282 */
	A0282("0282", 4, 2, 4),

	/** 0283 */
	A0283("0283", 4, 2, 4),

	/** 0284 */
	A0284("0284", 4, 2, 4),

	/** 0285 */
	A0285("0285", 4, 2, 4),

	/** 0287 */
	A0287("0287", 4, 2, 4),

	/** 0288 */
	A0288("0288", 4, 2, 4),

	/** 0289 */
	A0289("0289", 4, 2, 4),

	/** 0291 */
	A0291("0291", 4, 2, 4),

	/** 0293 */
	A0293("0293", 4, 2, 4),

	/** 0294 */
	A0294("0294", 4, 2, 4),

	/** 0295 */
	A0295("0295", 4, 2, 4),

	/** 0296 */
	A0296("0296", 4, 2, 4),

	/** 0297 */
	A0297("0297", 4, 2, 4),

	/** 0299 */
	A0299("0299", 4, 2, 4),

	/** 0422 */
	A0422("0422", 4, 2, 4),

	/** 0428 */
	A0428("0428", 4, 2, 4),

	/** 0436 */
	A0436("0436", 4, 2, 4),

	/** 0438 */
	A0438("0438", 4, 2, 4),

	/** 0439 */
	A0439("0439", 4, 2, 4),

	/** 0460 */
	A0460("0460", 4, 2, 4),

	/** 0463 */
	A0463("0463", 4, 2, 4),

	/** 0465 */
	A0465("0465", 4, 2, 4),

	/** 0466 */
	A0466("0466", 4, 2, 4),

	/** 0467 */
	A0467("0467", 4, 2, 4),

	/** 0470 */
	A0470("0470", 4, 2, 4),

	/** 0475 */
	A0475("0475", 4, 2, 4),

	/** 0476 */
	A0476("0476", 4, 2, 4),

	/** 0478 */
	A0478("0478", 4, 2, 4),

	/** 0479 */
	A0479("0479", 4, 2, 4),

	/** 0480 */
	A0480("0480", 4, 2, 4),

	/** 0493 */
	A0493("0493", 4, 2, 4),

	/** 0494 */
	A0494("0494", 4, 2, 4),

	/** 0495 */
	A0495("0495", 4, 2, 4),

	/** 0531 */
	A0531("0531", 4, 2, 4),

	/** 0532 */
	A0532("0532", 4, 2, 4),

	/** 0533 */
	A0533("0533", 4, 2, 4),

	/** 0536 */
	A0536("0536", 4, 2, 4),

	/** 0537 */
	A0537("0537", 4, 2, 4),

	/** 0538 */
	A0538("0538", 4, 2, 4),

	/** 0539 */
	A0539("0539", 4, 2, 4),

	/** 0544 */
	A0544("0544", 4, 2, 4),

	/** 0545 */
	A0545("0545", 4, 2, 4),

	/** 0547 */
	A0547("0547", 4, 2, 4),

	/** 0548 */
	A0548("0548", 4, 2, 4),

	/** 0550 */
	A0550("0550", 4, 2, 4),

	/** 0551 */
	A0551("0551", 4, 2, 4),

	/** 0553 */
	A0553("0553", 4, 2, 4),

	/** 0554 */
	A0554("0554", 4, 2, 4),

	/** 0555 */
	A0555("0555", 4, 2, 4),

	/** 0556 */
	A0556("0556", 4, 2, 4),

	/** 0557 */
	A0557("0557", 4, 2, 4),

	/** 0558 */
	A0558("0558", 4, 2, 4),

	/** 0561 */
	A0561("0561", 4, 2, 4),

	/** 0562 */
	A0562("0562", 4, 2, 4),

	/** 0563 */
	A0563("0563", 4, 2, 4),

	/** 0564 */
	A0564("0564", 4, 2, 4),

	/** 0565 */
	A0565("0565", 4, 2, 4),

	/** 0566 */
	A0566("0566", 4, 2, 4),

	/** 0567 */
	A0567("0567", 4, 2, 4),

	/** 0568 */
	A0568("0568", 4, 2, 4),

	/** 0569 */
	A0569("0569", 4, 2, 4),

	/** 0572 */
	A0572("0572", 4, 2, 4),

	/** 0573 */
	A0573("0573", 4, 2, 4),

	/** 0574 */
	A0574("0574", 4, 2, 4),

	/** 0575 */
	A0575("0575", 4, 2, 4),

	/** 0576 */
	A0576("0576", 4, 2, 4),

	/** 0577 */
	A0577("0577", 4, 2, 4),

	/** 0578 */
	A0578("0578", 4, 2, 4),

	/** 0581 */
	A0581("0581", 4, 2, 4),

	/** 0584 */
	A0584("0584", 4, 2, 4),

	/** 0585 */
	A0585("0585", 4, 2, 4),

	/** 0586 */
	A0586("0586", 4, 2, 4),

	/** 0587 */
	A0587("0587", 4, 2, 4),

	/** 0594 */
	A0594("0594", 4, 2, 4),

	/** 0595 */
	A0595("0595", 4, 2, 4),

	/** 0596 */
	A0596("0596", 4, 2, 4),

	/** 0597 */
	A0597("0597", 4, 2, 4),

	/** 0598 */
	A0598("0598", 4, 2, 4),

	/** 0599 */
	A0599("0599", 4, 2, 4),

	/** 0721 */
	A0721("0721", 4, 2, 4),

	/** 0725 */
	A0725("0725", 4, 2, 4),

	/** 0735 */
	A0735("0735", 4, 2, 4),

	/** 0736 */
	A0736("0736", 4, 2, 4),

	/** 0737 */
	A0737("0737", 4, 2, 4),

	/** 0738 */
	A0738("0738", 4, 2, 4),

	/** 0739 */
	A0739("0739", 4, 2, 4),

	/** 0740 */
	A0740("0740", 4, 2, 4),

	/** 0742 */
	A0742("0742", 4, 2, 4),

	/** 0743 */
	A0743("0743", 4, 2, 4),

	/** 0744 */
	A0744("0744", 4, 2, 4),

	/** 0745 */
	A0745("0745", 4, 2, 4),

	/** 0746 */
	A0746("0746", 4, 2, 4),

	/** 0747 */
	A0747("0747", 4, 2, 4),

	/** 0748 */
	A0748("0748", 4, 2, 4),

	/** 0749 */
	A0749("0749", 4, 2, 4),

	/** 0761 */
	A0761("0761", 4, 2, 4),

	/** 0763 */
	A0763("0763", 4, 2, 4),

	/** 0765 */
	A0765("0765", 4, 2, 4),

	/** 0766 */
	A0766("0766", 4, 2, 4),

	/** 0767 */
	A0767("0767", 4, 2, 4),

	/** 0768 */
	A0768("0768", 4, 2, 4),

	/** 0770 */
	A0770("0770", 4, 2, 4),

	/** 0771 */
	A0771("0771", 4, 2, 4),

	/** 0772 */
	A0772("0772", 4, 2, 4),

	/** 0773 */
	A0773("0773", 4, 2, 4),

	/** 0774 */
	A0774("0774", 4, 2, 4),

	/** 011 */
	A011("011", 3, 3, 4),

	/** 015 */
	A015("015", 3, 3, 4),

	/** 017 */
	A017("017", 3, 3, 4),

	/** 018 */
	A018("018", 3, 3, 4),

	/** 019 */
	A019("019", 3, 3, 4),

	/** 022 */
	A022("022", 3, 3, 4),

	/** 023 */
	A023("023", 3, 3, 4),

	/** 024 */
	A024("024", 3, 3, 4),

	/** 025 */
	A025("025", 3, 3, 4),

	/** 026 */
	A026("026", 3, 3, 4),

	/** 027 */
	A027("027", 3, 3, 4),

	/** 028 */
	A028("028", 3, 3, 4),

	/** 029 */
	A029("029", 3, 3, 4),

	/** 042 */
	A042("042", 3, 3, 4),

	/** 043 */
	A043("043", 3, 3, 4),

	/** 044 */
	A044("044", 3, 3, 4),

	/** 045 */
	A045("045", 3, 3, 4),

	/** 046 */
	A046("046", 3, 3, 4),

	/** 047 */
	A047("047", 3, 3, 4),

	/** 048 */
	A048("048", 3, 3, 4),

	/** 049 */
	A049("049", 3, 3, 4),

	/** 052 */
	A052("052", 3, 3, 4),

	/** 053 */
	A053("053", 3, 3, 4),

	/** 054 */
	A054("054", 3, 3, 4),

	/** 055 */
	A055("055", 3, 3, 4),

	/** 058 */
	A058("058", 3, 3, 4),

	/** 059 */
	A059("059", 3, 3, 4),

	/** 072 */
	A072("072", 3, 3, 4),

	/** 073 */
	A073("073", 3, 3, 4),

	/** 075 */
	A075("075", 3, 3, 4),

	/** 076 */
	A076("076", 3, 3, 4),

	/** 03 */
	A03("03", 2, 4, 4),

	/** 04 */
	A04("04", 2, 4, 4),

	/** 06 */
	A06("06", 2, 4, 4),

	// 特番(0AB0)

	/** 0120(着信課金) */
	S0120("0120", 4, 3, 3),

	/** 0800(着信課金) */
	S0800("0800", 4, 3, 3),

	/** 0130(マスコーリングサービス) */
	S0130("0130", 4, 3, 3),

	/** 0140(災害時応急復旧用無線電話) */
	S0140("0140", 4, 3, 3),

	/** 0150(自動船舶電話(1993.09.30廃止)) */
	S0150("0150", 4, 3, 3),

	/** 0450(自動船舶電話(1993.09.30廃止)) */
	S0450("0450", 4, 3, 3),

	/** 0750(自動船舶電話(1993.09.30廃止)) */
	S0750("0750", 4, 3, 3),

	/** 0160(災害用衛星電話) */
	S0160("0160", 4, 3, 3),

	/** 0170(伝言ダイヤル) */
	S0170("0170", 4, 3, 3),

	/** 0180(呼数集計) */
	S0180("0180", 4, 3, 3),

	/** 0190(番号案内直接接続) */
	S0190("0190", 4, 3, 3),

	/** 0570(全国統一番号) */
	S0570("0570", 4, 3, 3),

	/** 0910(公専接続) */
	S0910("0910", 4, 3, 3),

	/** 0990(災害募金サービス) */
	S0990("0990", 4, 3, 3),

	// 特番(0A0)

	/** 010800(国際着信課金電話番号) */
	S010800("010800", 3, 4, 4),

	/** 0201(M2M等) */
	S0201("0201", 3, 4, 4),

	/** 0202( M2M等) */
	S0202("0202", 3, 4, 4),

	/** 0203( M2M等) */
	S0203("0203", 3, 4, 4),

	/** 0204(発信者付加課金) */
	S0204("0204", 3, 4, 4),

	/** 0205(M2M等) */
	S0205("0205", 3, 4, 4),

	/** 0206(M2M等) */
	S0206("0206", 3, 4, 4),

	/** 0207(M2M等) */
	S0207("0207", 3, 4, 4),

	/** 0208(M2M等) */
	S0208("0208", 3, 4, 4),

	/** 0209(M2M等) */
	S0209("0209", 3, 4, 4),

	/** 010(国際接続番号) */
	S010("010", 3, 4, 4),

	/** 030(携帯電話に統合 自動車電話、沿岸船舶電話) */
	S030("030", 3, 4, 4),

	/** 040(携帯電話に統合 自動車電話、沿岸船舶電話) */
	S040("040", 3, 4, 4),

	/** 050(IP電話) */
	S050("050", 3, 4, 4),

	/** 060(eコール(2011.03.31廃止)) */
	S060("060", 3, 4, 4),

	/** 070(携帯電話/PHS) */
	S070("070", 3, 4, 4),

	/** 080(携帯電話/PHS) */
	S080("080", 3, 4, 4),

	/** 090(携帯電話/PHS) */
	S090("090", 3, 4, 4),

	;

	/** プレフィクス */
	private String prefix;

	/** 先頭桁数 */
	private int headLength;

	/** 中央桁数 */
	private int middleLength;

	/** 末尾桁数 */
	private int footLength;

	/**
	 * コンストラクタ<br>
	 * @param prefix プレフィクス
	 * @param headLength 先頭桁数
	 * @param middleLength 中央桁数
	 * @param footLength 末尾桁数
	 */
	private JapanesePhoneAreas(String prefix, int headLength, int middleLength, int footLength) {
		this.prefix = prefix;
		this.headLength = headLength;
		this.middleLength = middleLength;
		this.footLength = footLength;
	}

	/**
	 * 電話番号構成の桁数を取得します。<br>
	 * @return 電話番号構成の桁数
	 */
	public int getLength() {
		return headLength + middleLength + footLength;
	}

	/**
	 * 電話番号文字列に合致する市外局番情報を提供します。<br>
	 * @param phoneNumber 電話番号文字列
	 * @return 合致する市外局番情報
	 */
	public static JapanesePhoneAreas match(String phoneNumber) {
		if (phoneNumber == null) {
			return null;
		}
		String buffer = phoneNumber;
		buffer = buffer.replaceAll("[^0-9]+", "");
		buffer = buffer.trim();
		for (JapanesePhoneAreas e : values()) {
			if (buffer.length() != e.getLength()) {
				continue;
			}
			if (buffer.startsWith(e.prefix)) {
				return e;
			}
		}
		return null;
	}

	/**
	 * 電話番号文字列を電話番号桁構成に沿ってフォーマットした文字列を提供します。<br>
	 * 合致する市外局番が存在しない場合は指定された文字列をそのまま返却します。<br>
	 * @param phoneNumber 対象文字列
	 * @return フォーマット後電話番号文字列
	 */
	public static String format(String phoneNumber) {
		JapanesePhoneAreas area = match(phoneNumber);
		if (area == null) {
			return phoneNumber;
		}
		String buffer = phoneNumber.trim();
		buffer = buffer.replaceAll("[^0-9]+", "");
		buffer = buffer.trim();
		StringBuilder result = new StringBuilder();
		for (int i = 0; i <= area.headLength - 1; i++) {
			result.append(buffer.charAt(i));
		}
		result.append("-");
		for (int i = area.headLength; i <= area.headLength + area.middleLength - 1; i++) {
			result.append(buffer.charAt(i));
		}
		result.append("-");
		for (int i = area.headLength + area.middleLength; i <= area.headLength + area.middleLength + area.footLength - 1; i++) {
			result.append(buffer.charAt(i));
		}
		return result.toString();
	}
}
